# C# Task.WhenAll vs Task.WhenAny ë¹„êµ

## ğŸ”¹ ê°œë… ë¹„êµ

| êµ¬ë¶„ | Task.WhenAll | Task.WhenAny |
|---|---|---|
| ì˜ë¯¸ | ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸° | í•˜ë‚˜ì˜ ì‘ì—…ë§Œ ì™„ë£Œë˜ë©´ ëŒ€ê¸° ì¢…ë£Œ |
| ë°˜í™˜ ê°’ | ì™„ë£Œëœ ëª¨ë“  Taskì˜ ë°°ì—´ | ê°€ì¥ ë¨¼ì € ì™„ë£Œëœ Task í•˜ë‚˜ |
| ì˜ˆì™¸ ì²˜ë¦¬ | í•˜ë‚˜ë¼ë„ ì˜ˆì™¸ë©´ AggregateException ë°œìƒ (ì „ë¶€ ì™„ë£Œ í›„ ì˜ˆì™¸ ë°˜í™˜) | ì™„ë£Œëœ Taskê°€ ì˜ˆì™¸ë©´ í•´ë‹¹ Taskì—ì„œë§Œ ì˜ˆì™¸ ë°œìƒ |

---

## ğŸ”¸ Task.WhenAll ì‚¬ìš© ì¼€ì´ìŠ¤

### âœ… ì‹¤ì œ ì¼€ì´ìŠ¤
- ì—¬ëŸ¬ API í˜¸ì¶œì„ ë™ì‹œì— ë‚ ë¦¬ê³ , ëª¨ë“  ì‘ë‹µì´ ë„ì°©í•˜ë©´ ì²˜ë¦¬
- ë³‘ë ¬ë¡œ íŒŒì¼ì„ ì½ê±°ë‚˜ ì—…ë¡œë“œ í›„ ì „ì²´ ì™„ë£Œ ëŒ€ê¸°
- ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ë¥¼ ë™ì‹œì— ë³´ë‚´ê³  ëª¨ë‘ ì‘ë‹µ ê¸°ë‹¤ë¦¼

### âœ… ì˜ˆì‹œ ì½”ë“œ

```csharp
var tasks = new[]
{
    GetDataFromApiAsync(),
    ReadFileAsync("file.txt"),
    QueryDatabaseAsync()
};

await Task.WhenAll(tasks);
Console.WriteLine("ëª¨ë“  ì‘ì—… ì™„ë£Œ");
```

### âœ… íŠ¹ì§•
- ëª¨ë“  ì‘ì—…ì„ ë³‘ë ¬ë¡œ ì²˜ë¦¬
- í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ AggregateException ë°œìƒ
- ì „ë¶€ ì„±ê³µí•˜ê±°ë‚˜ ì‹¤íŒ¨ ì—¬ë¶€ ìƒê´€ì—†ì´ ëê¹Œì§€ ê¸°ë‹¤ë¦¼

---

## ğŸ”¸ Task.WhenAny ì‚¬ìš© ì¼€ì´ìŠ¤

### âœ… ì‹¤ì œ ì¼€ì´ìŠ¤
- ê°€ì¥ ë¹ ë¥¸ ì‘ë‹µì„ ì‚¬ìš©í•˜ëŠ” ë¡œì§ (API ì„œë²„ ì¤‘ ê°€ì¥ ë¹ ë¥¸ ì‘ë‹µ ì„ íƒ)
- ì—¬ëŸ¬ ëŒ€ì˜ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê³  ì²« ë²ˆì§¸ ì‘ë‹µë§Œ ì‚¬ìš©
- íƒ€ì„ì•„ì›ƒ êµ¬í˜„ (Delay Taskì™€ ê²°í•©)

### âœ… ì˜ˆì‹œ ì½”ë“œ

```csharp
var tasks = new[]
{
    GetDataFromApi1Async(),
    GetDataFromApi2Async(),
    GetDataFromApi3Async()
};

var firstCompleted = await Task.WhenAny(tasks);
var result = await firstCompleted;

Console.WriteLine($"ê°€ì¥ ë¹ ë¥¸ ì‘ë‹µ: {result}");
```

### âœ… íŠ¹ì§•
- ê°€ì¥ ë¨¼ì € ì™„ë£Œëœ ì‘ì—…ë§Œ ê¸°ë‹¤ë¦¼
- ë‚˜ë¨¸ì§€ TaskëŠ” ëª…ì‹œì ìœ¼ë¡œ ì·¨ì†Œí•˜ê±°ë‚˜ ê¸°ë‹¤ë¦¬ì§€ ì•Šìœ¼ë©´ ê³„ì† ì‹¤í–‰ë¨

---

## ğŸ”¸ WhenAll vs WhenAny êµ¬ì²´ì  ì°¨ì´

| í•­ëª© | Task.WhenAll | Task.WhenAny |
|---|---|---|
| ëª©ì  | ëª¨ë“  ì‘ì—… ê²°ê³¼ í•„ìš” | ë¹ ë¥¸ ì‘ì—… í•˜ë‚˜ë§Œ í•„ìš” |
| ì„±ëŠ¥ | ì‘ì—… ìˆ˜ë§Œí¼ ThreadPool ì†Œëª¨ | ì‘ì—… ìˆ˜ë§Œí¼ ì‹œì‘ë˜ì§€ë§Œ, í•˜ë‚˜ë§Œ í•„ìš”ì‹œ íš¨ìœ¨ì  |
| ì˜¤ë¥˜ ì²˜ë¦¬ | AggregateException (ëª¨ë“  ì‘ì—… ì™„ë£Œ í›„) | ì™„ë£Œëœ ì‘ì—…ì˜ ì˜ˆì™¸ë§Œ í•´ë‹¹ |
| í›„ì²˜ë¦¬ | ê° Task ë³„ í›„ì²˜ë¦¬ í•„ìš” | ì™„ë£Œ Taskë§Œ ì²˜ë¦¬ ê°€ëŠ¥ |
| ìì› í•´ì œ | ì „ì²´ê°€ ëë‚  ë•Œ | ì™„ë£Œ í›„ ë¯¸ì‚¬ìš© TaskëŠ” ëª…ì‹œì  ì·¨ì†Œ í•„ìš” |

---

## ğŸ”¸ Task.WhenAll ëŒ€ì•ˆ

| ëŒ€ì•ˆ | ì„¤ëª… | ì‚¬ìš© ì˜ˆì‹œ |
|------|------|------|
| Parallel.ForEachAsync (.NET 6 ì´ìƒ) | ë¹„ë™ê¸° ë³‘ë ¬ ì²˜ë¦¬ | IO Bound ì‘ì—… ë³‘ë ¬ ì²˜ë¦¬ |
| Parallel.ForEach | CPU Bound ë³‘ë ¬ ì²˜ë¦¬ | ëŒ€ëŸ‰ ê³„ì‚° ì²˜ë¦¬ |
| Channel + Producer/Consumer | ëŒ€ëŸ‰ ë¹„ë™ê¸° ì‘ì—… í | ëŒ€ëŸ‰ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ |
| SemaphoreSlim | ì œí•œëœ ë™ì‹œì„± ì²˜ë¦¬ | API Rate Limit ëŒ€ì‘ |

### âœ… ì˜ˆì‹œ (ë™ì‹œì„± ì œí•œ)

```csharp
var semaphore = new SemaphoreSlim(3);

var tasks = urls.Select(async url =>
{
    await semaphore.WaitAsync();
    try
    {
        return await DownloadAsync(url);
    }
    finally
    {
        semaphore.Release();
    }
});

var results = await Task.WhenAll(tasks);
```

---

## ğŸ”¸ Task.WhenAny ëŒ€ì•ˆ

| ëŒ€ì•ˆ | ì„¤ëª… | ì‚¬ìš© ì˜ˆì‹œ |
|------|------|------|
| CancellationToken | ì²« ë²ˆì§¸ ì™„ë£Œ í›„ ë‚˜ë¨¸ì§€ ì·¨ì†Œ | íƒ€ì„ì•„ì›ƒ ë˜ëŠ” ë¹ ë¥¸ ì‘ë‹µ ëŒ€ê¸° |
| Task.WaitAny() (ë™ê¸°) | ë™ê¸° ë²„ì „ | ì½˜ì†” ì•± ë˜ëŠ” ì´ˆê¸°í™” ì½”ë“œ |
| Custom TaskCompletionSource | íŠ¹ì • ì¡°ê±´ì—ì„œ ì™„ë£Œë˜ëŠ” Task ìƒì„± | ì´ë²¤íŠ¸ ê¸°ë°˜ ë¹„ë™ê¸° |
| Task.Delay() ì¡°í•© | íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬ | ì¼ì • ì‹œê°„ ëŒ€ê¸° ë˜ëŠ” íƒ€ì„ì•„ì›ƒ |

### âœ… ì˜ˆì‹œ (íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬)

```csharp
var task = DownloadAsync();
var timeout = Task.Delay(5000);

var completed = await Task.WhenAny(task, timeout);

if (completed == timeout)
{
    Console.WriteLine("íƒ€ì„ì•„ì›ƒ ë°œìƒ");
}
else
{
    var result = await task;
    Console.WriteLine($"ì„±ê³µ: {result}");
}
```

---

## ğŸ”¸ ì •ë¦¬

| ìƒí™© | ì¶”ì²œ |
|---|---|
| ëª¨ë“  ê²°ê³¼ í•„ìš” | âœ… Task.WhenAll |
| ì¼ë¶€ë¼ë„ ì™„ë£Œë˜ë©´ ì¶©ë¶„ | âœ… Task.WhenAny |
| ë™ì‹œì„± ì œí•œ í•„ìš” | âœ… SemaphoreSlim + Task.WhenAll |
| ë¹ ë¥¸ ì‘ë‹µ + íƒ€ì„ì•„ì›ƒ | âœ… Task.WhenAny + Task.Delay |
| CPU ë°”ìš´ë“œ ë³‘ë ¬ | âœ… Parallel.ForEach |
| ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ | âœ… Channel + Consumer Pattern |
